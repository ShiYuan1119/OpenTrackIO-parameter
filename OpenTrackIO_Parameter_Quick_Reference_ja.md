# OpenTrackIO パラメータクイックリファレンス

## パラメータ分類表

### 静的パラメータ (Static)

| パラメータ | JSONキー名 | 型 | 単位 | 範囲/制約 | 必須 |
|----------|-----------|---|-----|----------|------|
| 継続時間 | `duration` | 有理数 | 秒 | > 0 | ❌ |
| キャプチャフレームレート | `captureFrameRate` | 有理数 | Hz | > 0 | ❌ |
| センサー物理寸法 | `activeSensorPhysicalDimensions` | オブジェクト | mm | ≥ 0 | ❌ |
| センサー解像度 | `activeSensorResolution` | オブジェクト | ピクセル | [0, 2³¹-1] | ❌ |
| カメラ製造業者 | `make` | 文字列 | - | 1-1023文字 | ❌ |
| カメラモデル | `model` | 文字列 | - | 1-1023文字 | ❌ |
| シリアル番号 | `serialNumber` | 文字列 | - | 1-1023文字 | ❌ |
| ファームウェアバージョン | `firmwareVersion` | 文字列 | - | 1-1023文字 | ❌ |
| カメララベル | `label` | 文字列 | - | 1-1023文字 | ❌ |
| アナモルフィック圧縮比 | `anamorphicSqueeze` | 有理数 | - | > 0 | ❌ |
| ISO感度 | `isoSpeed` | 整数 | - | > 0 | ❌ |
| FDLリンク | `fdlLink` | UUID URN | - | 有効UUID | ❌ |
| シャッター角度 | `shutterAngle` | 実数 | 度 | (0, 360] | ❌ |

### トラッカーパラメータ (Tracker)

| パラメータ | JSONキー名 | 型 | 単位 | 範囲/制約 | 必須 |
|----------|-----------|---|-----|----------|------|
| 備考 | `notes` | 文字列 | - | 1-1023文字 | ❌ |
| 録画状態 | `recording` | ブール | - | true/false | ❌ |
| スレート | `slate` | 文字列 | - | 1-1023文字 | ❌ |
| 状態 | `status` | 文字列 | - | 1-1023文字 | ❌ |

### タイムパラメータ (Timing)

| パラメータ | JSONキー名 | 型 | 単位 | 範囲/制約 | 必須 |
|----------|-----------|---|-----|----------|------|
| タイムモード | `mode` | 列挙 | - | internal/external | ❌ |
| 録画タイムスタンプ | `recordedTimestamp` | オブジェクト | 秒 | 48ビット秒+32ビットナノ秒 | ❌ |
| サンプリングレート | `sampleRate` | 有理数 | Hz | > 0 | ❌ |
| サンプルタイムスタンプ | `sampleTimestamp` | オブジェクト | 秒 | 48ビット秒+32ビットナノ秒 | ❌ |
| シーケンス番号 | `sequenceNumber` | 整数 | - | ≥ 0 | ❌ |
| 同期情報 | `synchronization` | オブジェクト | - | 複合オブジェクト | ❌ |
| タイムコード | `timecode` | オブジェクト | - | SMPTE形式 | ❌ |

### レンズパラメータ (Lens)

| パラメータ | JSONキー名 | 型 | 単位 | 範囲/制約 | 必須 |
|----------|-----------|---|-----|----------|------|
| カスタム係数 | `custom` | 配列 | - | 浮動小数点数配列 | ❌ |
| 歪みパラメータ | `distortion` | 配列 | - | 歪みオブジェクト配列 | ❌ |
| 歪みオフセット | `distortionOffset` | オブジェクト | mm | 実数 | ❌ |
| エンコーダー位置 | `encoders` | オブジェクト | - | [0, 1] | ❌ |
| 入射瞳オフセット | `entrancePupilOffset` | 実数 | メートル | 実数 | ❌ |
| 露出減衰 | `exposureFalloff` | オブジェクト | - | 実数係数 | ❌ |
| F値 | `fStop` | 実数 | - | > 0 | ❌ |
| ピンホール焦点距離 | `pinholeFocalLength` | 実数 | mm | > 0 | ❌ |
| フォーカス距離 | `focusDistance` | 実数 | メートル | > 0 | ❌ |
| 投影オフセット | `projectionOffset` | オブジェクト | mm | 実数 | ❌ |
| 生エンコーダー | `rawEncoders` | オブジェクト | - | ≥ 0 | ❌ |
| T値 | `tStop` | 実数 | - | > 0 | ❌ |

### プロトコル識別 (Protocol)

| パラメータ | JSONキー名 | 型 | 単位 | 範囲/制約 | 必須 |
|----------|-----------|---|-----|----------|------|
| プロトコル名 | `name` | 文字列 | - | "OpenTrackIO" | ✅ |
| プロトコルバージョン | `version` | 配列 | - | [メジャー,マイナー,パッチ] | ✅ |

### 変換パラメータ (Transforms)

| パラメータ | JSONキー名 | 型 | 単位 | 範囲/制約 | 必須 |
|----------|-----------|---|-----|----------|------|
| 平行移動 | `translation` | オブジェクト | メートル | 実数 | ✅ |
| 回転 | `rotation` | オブジェクト | 度 | 実数 | ✅ |
| スケール | `scale` | オブジェクト | - | 実数 | ❌ |
| 識別子 | `id` | 文字列 | - | 1-1023文字 | ❌ |

---

## データサンプリング型

### Static (静的)
- **定義**: セグメント全体を通じて変化しないパラメータ
- **例**: カメラモデル、レンズシリアル番号、センサー寸法
- **格納**: `static`オブジェクト内

### Regular (通常)
- **定義**: 各サンプルで変化する可能性があるパラメータ
- **例**: カメラ位置、レンズフォーカス、トラッカー状態
- **格納**: メインオブジェクト内、配列形式

---

## 単位系

| 物理量 | 単位 | 記号 | 説明 |
|-------|------|------|------|
| 長さ | メートル | m | 空間座標、距離 |
| 長さ | ミリメートル | mm | レンズパラメータ、オフセット |
| 角度 | 度 | ° | 回転、シャッター角度 |
| 時間 | 秒 | s | タイムスタンプ、継続時間 |
| 周波数 | ヘルツ | Hz | フレームレート、サンプリングレート |
| 解像度 | ピクセル | px | 画像サイズ |

---

## 一般的な列挙値

### TimingMode
- `"internal"`: 内部タイムモード
- `"external"`: 外部タイムモード

### SynchronizationSource
- `"genlock"`: 同期ロック
- `"videoIn"`: ビデオ入力
- `"ptp"`: 精密時間プロトコル
- `"ntp"`: ネットワーク時間プロトコル

### PTPProfile
- `"IEEE Std 1588-2019"`: IEEE標準
- `"IEEE Std 802.1AS-2020"`: オーディオビデオブリッジ
- `"SMPTE ST2059-2:2021"`: SMPTE標準

### PTPLeaderTimeSource
- `"GNSS"`: 全球測位衛星システム
- `"Atomic clock"`: 原子時計
- `"NTP"`: ネットワーク時間プロトコル

### DistortionModel
- `"Brown-Conrady D-U"`: 歪みから非歪みへ
- `"Brown-Conrady U-D"`: 非歪みから歪みへ

---

## 検証チェックリスト

### データ整合性
- [ ] プロトコル名とバージョンが正しい
- [ ] 必須フィールドが存在する
- [ ] データ型が一致している
- [ ] 数値範囲が有効

### 論理一貫性
- [ ] タイムスタンプが増加している
- [ ] フレーム数がフレームレートより小さい
- [ ] エンコーダー値が有効範囲内
- [ ] UUID形式が正しい

### パフォーマンスチェック
- [ ] データサイズが合理的
- [ ] サンプリングレートが適切
- [ ] ネットワーク帯域幅が十分
- [ ] 処理遅延が受容可能

---

## トラブルシューティング

### 解析エラー
```
ValidationError: 1 validation error for Clip
lens.fStop.0
  Input should be greater than 0
```

**解決**: fStop値が正数であることを確認

### タイム同期問題
```
Warning: PTP synchronization lost
```

**解決**: ネットワーク接続とPTP設定をチェック

### 歪みパラメータエラー
```
ValueError: radial distortion coefficient sequence must not be empty
```

**解決**: 径方向歪み係数配列が空でないことを確認

---

## ベストプラクティス要約

1. **有理数を使用**: フレームレートと時間の正確な表現
2. **入力を検証**: 受信データを常に検証
3. **オプションフィールドを処理**: 欠損データを優雅に処理
4. **バージョンチェック**: プロトコルバージョン互換性を確認
5. **単位の一貫性**: 単位規約を厳密に遵守
6. **パフォーマンス監視**: 解析と伝送パフォーマンスを監視
7. **エラー処理**: 完全なエラー回復メカニズムを実装

---

*クイックリファレンスマニュアルバージョン: 1.0.0*